version: v1.0
name: Pipeline
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804
  containers:
    - name: main
      image: 'semaphoreci/ubuntu:18.04'
blocks:
  - name: Backend - Lint
    dependencies: []
    task:
      jobs:
        - name: Lint
          commands:
            - echo "here"
  - name: Backend - Tests
    dependencies:
      - Backend - Lint
    task:
      jobs:
        - name: Tests
          commands:
            - echo "backend"
          parallelism: 4
  - name: Frontend - Lint
    dependencies: []
    task:
      jobs:
        - name: Lint
          commands:
            - echo "here"
  - name: Frontend - Tests
    dependencies:
      - Frontend - Lint
    task:
      jobs:
        - name: Tests
          commands:
            - echo "front"
          parallelism: 4
  - name: E2E
    dependencies:
      - Backend - Tests
      - Frontend - Tests
    task:
      jobs:
        - name: e2e
          commands:
            - echo "e2e"
  - name: "\U0001F680 Release"
    dependencies:
      - E2E
    task:
      jobs:
        - name: release
          commands:
            - make release
  - name: Linux build
    dependencies:
      - Frontend - Lint
    task:
      agent:
        machine:
          type: e1-standard-2
          os_image: ubuntu1804
      jobs:
        - name: Seomthing eles
          commands:
            - uname -a
  - name: Mac machine
    dependencies:
      - Frontend - Lint
    task:
      agent:
        machine:
          type: a1-standard-4
          os_image: macos-mojave-xcode11
      jobs:
        - name: 'Job #1'
          commands:
            - uname -a
  - name: Android build
    dependencies:
      - Frontend - Lint
    task:
      agent:
        machine:
          type: e1-standard-2
          os_image: ubuntu1804
        containers:
          - name: main
            image: 'semaphoreci/android:27-node'
      jobs:
        - name: 'Job #1 56'
          commands: []
promotions:
  - name: Promotion 2
    pipeline_file: pipeline_7.yml
  - name: Promotion 3
    pipeline_file: pipeline_8.yml
  - name: Promotion 4
    pipeline_file: pipeline_9.yml
